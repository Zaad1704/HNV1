import{j as t,b as e}from"./index-7df8bb8f.js";import{r}from"./vendor-83d6deea.js";import{u as d}from"./query-c0dd8be7.js";import"./router-225372b8.js";import"./i18n-eaa6a7d3.js";import"./utils-2ffb253a.js";import"./ui-88b07fc3.js";const a=async()=>{const{data:t}=await e.get("/users/organization");return t.data},s=()=>{const[s,l]=r.useState({userId:"",action:"",startDate:"",endDate:""}),{data:o=[],isLoading:i,isError:x}=d({queryKey:["auditLogs",s],queryFn:()=>(async t=>{const{data:r}=await e.get("/audit",{params:t});return r.data})(s)}),{data:n=[]}=d({queryKey:["orgUsersForAudit"],queryFn:a}),c=t=>{l(e=>({...e,[t.target.name]:t.target.value}))};return t.jsxs("div",{className:"text-dark-text dark:text-dark-text-dark",children:[t.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Audit Log"}),t.jsxs("div",{className:"p-4 bg-light-card rounded-xl border border-border-color mb-6 grid grid-cols-1 md:grid-cols-4 gap-4 dark:bg-dark-card dark:border-border-color-dark",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-light-text dark:text-light-text-dark",children:"User"}),t.jsxs("select",{name:"userId",value:s.userId,onChange:c,className:"w-full mt-1 p-2 border border-border-color rounded-md bg-light-bg text-dark-text dark:bg-dark-bg dark:border-border-color-dark dark:text-dark-text-dark",children:[t.jsx("option",{value:"",children:"All Users"}),n.map(e=>t.jsx("option",{value:e._id,children:e.name},e._id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-light-text dark:text-light-text-dark",children:"Action Type"}),t.jsx("input",{type:"text",name:"action",placeholder:"e.g., TENANT_UPDATE",value:s.action,onChange:c,className:"w-full mt-1 p-2 border border-border-color rounded-md bg-light-bg text-dark-text dark:bg-dark-bg dark:border-border-color-dark dark:text-dark-text-dark"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-light-text dark:text-light-text-dark",children:"Start Date"}),t.jsx("input",{type:"date",name:"startDate",value:s.startDate,onChange:c,className:"w-full mt-1 p-2 border border-border-color rounded-md bg-light-bg text-dark-text dark:bg-dark-bg dark:border-border-color-dark dark:text-dark-text-dark"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-light-text dark:text-light-text-dark",children:"End Date"}),t.jsx("input",{type:"date",name:"endDate",value:s.endDate,onChange:c,className:"w-full mt-1 p-2 border border-border-color rounded-md bg-light-bg text-dark-text dark:bg-dark-bg dark:border-border-color-dark dark:text-dark-text-dark"})]})]}),t.jsx("div",{className:"bg-light-card rounded-xl shadow-lg border border-border-color overflow-hidden dark:bg-dark-card dark:border-border-color-dark",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{className:"bg-light-bg border-b border-border-color dark:bg-dark-bg/50 dark:border-border-color-dark",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"User"}),t.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"Action"}),t.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"Details"}),t.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"Date & Time"})]})}),t.jsx("tbody",{className:"divide-y divide-border-color dark:divide-border-color-dark",children:i?t.jsx("tr",{children:t.jsx("td",{colSpan:4,className:"p-8 text-center text-light-text dark:text-light-text-dark",children:"Loading logs..."})}):x?t.jsx("tr",{children:t.jsx("td",{colSpan:4,className:"p-8 text-center text-red-400 dark:text-red-400",children:"Failed to fetch logs."})}):o.length>0?o.map(e=>{var r,d,a;return t.jsxs("tr",{className:"hover:bg-light-bg transition-colors duration-150 dark:hover:bg-dark-bg/40",children:[t.jsxs("td",{className:"p-4 align-top",children:[t.jsx("p",{className:"font-semibold text-dark-text dark:text-dark-text-dark",children:(null==(r=e.user)?void 0:r.name)||"N/A"}),t.jsx("p",{className:"text-xs text-light-text dark:text-light-text-dark",children:(null==(d=e.user)?void 0:d.email)||"Unknown"})]}),t.jsx("td",{className:"p-4 align-top",children:t.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-brand-primary/20 text-brand-primary",children:e.action})}),t.jsx("td",{className:"p-4 align-top text-xs text-light-text font-mono dark:text-light-text-dark",children:e.details&&Object.entries(e.details).map(([e,r])=>t.jsxs("div",{children:[t.jsxs("strong",{className:"text-dark-text dark:text-dark-text-dark",children:[e,":"]})," ",JSON.stringify(r)]},e))}),t.jsx("td",{className:"p-4 align-top text-sm text-light-text dark:text-light-text-dark",children:(a=e.timestamp,new Date(a).toLocaleString("en-US",{dateStyle:"medium",timeStyle:"short"}))})]},e._id)}):t.jsx("tr",{children:t.jsx("td",{colSpan:4,className:"p-8 text-center text-light-text dark:text-light-text-dark",children:"No audit log entries found for the selected filters."})})})]})})})]})};export{s as default};
