import{j as e,b as t}from"./index-7df8bb8f.js";import{r as s}from"./vendor-83d6deea.js";import{u as a}from"./i18n-eaa6a7d3.js";import{c as r,a as l,u as i}from"./query-c0dd8be7.js";import{a as n,m as o,j as d,X as c,a8 as p,a9 as m,aa as x,g as u,a6 as h,Y as b,U as y,ab as f,ac as j,D as g,V as v,ad as N}from"./ui-88b07fc3.js";import{L as w}from"./router-225372b8.js";import"./utils-2ffb253a.js";const k=({isOpen:l,onClose:i,onPropertyAdded:m})=>{const{t:x}=a(),[u,h]=s.useState({name:"",street:"",city:"",state:"",zipCode:"",numberOfUnits:1}),[b,y]=s.useState(null),[f,j]=s.useState(""),g=r({mutationFn:e=>t.post("/properties",e,{headers:{"Content-Type":"multipart/form-data"}}),onSuccess:e=>{m(e.data.data),i(),h({name:"",street:"",city:"",state:"",zipCode:"",numberOfUnits:1}),y(null),j("")},onError:e=>{var t,s;return j((null==(s=null==(t=e.response)?void 0:t.data)?void 0:s.message)||"Failed to add property.")}}),v=e=>{h({...u,[e.target.name]:e.target.value})};return e.jsx(n,{children:l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex justify-center items-center p-4",children:e.jsxs(o.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"app-surface rounded-3xl shadow-app-xl w-full max-w-lg border border-app-border",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-app-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 app-gradient rounded-xl flex items-center justify-center",children:e.jsx(d,{size:20,className:"text-white"})}),e.jsx("h2",{className:"text-xl font-bold text-text-primary",children:x("property.add_new_property")})]}),e.jsx("button",{onClick:i,className:"p-2 rounded-full text-text-secondary hover:text-text-primary hover:bg-app-bg transition-all",children:e.jsx(c,{size:20})})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),j("");const t=new FormData;t.append("name",u.name),t.append("address[street]",u.street),t.append("address[city]",u.city),t.append("address[state]",u.state),t.append("address[zipCode]",u.zipCode),t.append("numberOfUnits",u.numberOfUnits.toString()),b&&t.append("image",b),g.mutate(t)},className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto",children:[f&&e.jsx(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-600 p-4 rounded-2xl text-sm",children:f}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-text-secondary mb-2",children:x("property.property_name")}),e.jsx("input",{type:"text",name:"name",id:"name",required:!0,value:u.name,onChange:v,className:"w-full",placeholder:x("property.enter_property_name")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:x("property.address")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("input",{name:"street",placeholder:x("property.street_address"),value:u.street,onChange:v,className:"sm:col-span-2"}),e.jsx("input",{name:"city",placeholder:x("property.city"),value:u.city,onChange:v}),e.jsx("input",{name:"state",placeholder:x("property.state"),value:u.state,onChange:v}),e.jsx("input",{name:"zipCode",placeholder:x("property.zip_code"),value:u.zipCode,onChange:v})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"numberOfUnits",className:"block text-sm font-medium text-text-secondary mb-2",children:x("property.number_of_units")}),e.jsx("input",{type:"number",min:"1",name:"numberOfUnits",id:"numberOfUnits",required:!0,value:u.numberOfUnits,onChange:v,placeholder:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"image",className:"block text-sm font-medium text-text-secondary mb-2",children:x("property.property_image")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",name:"image",id:"image",onChange:e=>{e.target.files&&y(e.target.files[0])},accept:"image/*",className:"hidden"}),e.jsx("label",{htmlFor:"image",className:"flex items-center justify-center w-full p-6 border-2 border-dashed border-app-border rounded-2xl cursor-pointer hover:border-brand-blue hover:bg-brand-blue/5 transition-all",children:e.jsxs("div",{className:"text-center",children:[e.jsx(p,{size:24,className:"mx-auto text-text-muted mb-2"}),e.jsx("p",{className:"text-sm text-text-secondary",children:b?b.name:x("property.click_to_upload")})]})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:i,className:"px-6 py-3 rounded-2xl border border-app-border text-text-secondary hover:text-text-primary hover:bg-app-bg transition-all",children:x("common.cancel")}),e.jsxs("button",{type:"submit",disabled:g.isLoading,className:"btn-gradient px-6 py-3 rounded-2xl flex items-center gap-2 disabled:opacity-50",children:[g.isLoading?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(d,{size:16}),g.isLoading?x("property.saving"):x("property.save_property")]})]})]})]})})})},C=({onSearch:t,onFilter:r,filters:l={},placeholder:i,filterOptions:d=[]})=>{const{t:p}=a(),[u,h]=s.useState(""),[b,y]=s.useState(!1),[f,j]=s.useState(l),g=(e,t)=>{const s={...f,[e]:t};j(s),r(s)},v=Object.keys(f).filter(e=>f[e]).length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(m,{size:20,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-text-muted"}),e.jsx("input",{type:"text",value:u,onChange:e=>{return s=e.target.value,h(s),void t(s);var s},placeholder:i||p("common.search"),className:"w-full pl-12 pr-16 py-3 rounded-2xl border border-app-border bg-app-surface"}),e.jsxs("button",{onClick:()=>y(!b),className:"absolute right-4 top-1/2 transform -translate-y-1/2 p-2 rounded-full transition-colors "+(b?"text-brand-blue bg-brand-blue/10":"text-text-muted hover:text-text-primary"),children:[e.jsx(x,{size:16}),v>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-brand-orange text-white text-xs rounded-full flex items-center justify-center",children:v})]})]}),e.jsx(n,{children:b&&e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"app-surface rounded-2xl border border-app-border p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-text-primary",children:p("common.filter")}),v>0&&e.jsxs("button",{onClick:()=>{j({}),r({})},className:"text-sm text-brand-blue hover:text-brand-blue/80 flex items-center gap-1",children:[e.jsx(c,{size:14}),p("common.clear_all")]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(t=>{var s,a;return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:t.label}),"select"===t.type&&e.jsxs("select",{value:f[t.key]||"",onChange:e=>g(t.key,e.target.value),className:"w-full p-2 rounded-xl border border-app-border bg-app-surface",children:[e.jsx("option",{value:"",children:p("common.all")}),null==(s=t.options)?void 0:s.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),"checkbox"===t.type&&e.jsx("div",{className:"space-y-2",children:null==(a=t.options)?void 0:a.map(s=>{var a;return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:(null==(a=f[t.key])?void 0:a.includes(s.value))||!1,onChange:e=>{const a=f[t.key]||[],r=e.target.checked?[...a,s.value]:a.filter(e=>e!==s.value);g(t.key,r)},className:"rounded"}),e.jsx("span",{className:"text-sm text-text-primary",children:s.label})]},s.value)})})]},t.key)})})]})})]})},z=({selectedItems:t,totalItems:r,onSelectAll:l,onClearSelection:i,actions:d})=>{a();const[p,m]=s.useState(!1);return 0===t.length?null:e.jsx(n,{children:e.jsx(o.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"fixed bottom-4 left-4 right-4 md:left-1/2 md:right-auto md:transform md:-translate-x-1/2 z-50",children:e.jsxs("div",{className:"app-surface rounded-2xl border border-app-border shadow-app-xl p-4 backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 app-gradient rounded-full flex items-center justify-center",children:e.jsx(u,{size:16,className:"text-white"})}),e.jsxs("span",{className:"font-semibold text-text-primary",children:[t.length," of ",r," selected"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:l,className:"text-sm text-brand-blue hover:text-brand-blue/80 font-medium",children:"Select All"}),e.jsx("button",{onClick:i,className:"p-2 rounded-full text-text-secondary hover:text-text-primary hover:bg-app-bg",children:e.jsx(c,{size:16})})]})]}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto",children:d.map(s=>e.jsxs("button",{onClick:()=>(async e=>{m(!0);try{await e(t)}finally{m(!1)}})(s.action),disabled:p,className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium text-sm transition-all whitespace-nowrap ${s.color} disabled:opacity-50`,children:[e.jsx(s.icon,{size:16}),s.label]},s.key))})]})})})},_=async()=>{const{data:e}=await t.get("/properties");return e.data},S=()=>{const{t:r}=a(),[n,c]=s.useState(!1),[p,m]=s.useState([]),[x,u]=s.useState(""),[S,U]=s.useState({}),O=l(),{exportProperties:L,isExporting:F}=(()=>{const[e,a]=s.useState(!1),r=async(e,s)=>{a(!0);try{const a=await t.post(`/export/${e}`,s,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([a.data])),l=document.createElement("a");l.href=r;const i=s.format,n=(new Date).toISOString().split("T")[0];return l.download=`${e}-export-${n}.${i}`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(r),!0}catch(r){return!1}finally{a(!1)}};return{isExporting:e,exportProperties:e=>r("properties",e),exportTenants:e=>r("tenants",e),exportPayments:e=>r("payments",e),exportFinancials:e=>r("financials",e)}})(),{data:A,isLoading:D}=i({queryKey:["properties"],queryFn:_}),I=s.useMemo(()=>A?A.filter(e=>{var t,s;const a=!x||e.name.toLowerCase().includes(x.toLowerCase())||(null==(s=null==(t=e.address)?void 0:t.city)?void 0:s.toLowerCase().includes(x.toLowerCase())),r=!S.status||e.status===S.status,l=!S.units||"single"===S.units&&1===e.numberOfUnits||"multiple"===S.units&&e.numberOfUnits>1;return a&&r&&l}):[],[A,x,S]),P=[{key:"status",label:"Status",type:"select",options:[{value:"Active",label:r("property.active")},{value:"Inactive",label:r("property.inactive")}]},{key:"units",label:"Unit Type",type:"select",options:[{value:"single",label:"Single Unit"},{value:"multiple",label:"Multiple Units"}]}],T=[{key:"export",label:"Export",icon:g,color:"bg-blue-500 hover:bg-blue-600 text-white",action:async e=>{await L({format:"xlsx",filters:{ids:e}})}},{key:"contact",label:"Contact Tenants",icon:v,color:"bg-green-500 hover:bg-green-600 text-white",action:e=>{}},{key:"delete",label:"Delete",icon:N,color:"bg-red-500 hover:bg-red-600 text-white",action:e=>{confirm("Delete selected properties?")}}];return D?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"w-8 h-8 app-gradient rounded-full animate-pulse"}),e.jsx("span",{className:"ml-3 text-text-secondary",children:r("property.loading_properties")})]}):e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:r("dashboard.properties")}),e.jsx("p",{className:"text-text-secondary mt-1",children:r("property.manage_portfolio")})]}),e.jsxs("button",{onClick:()=>c(!0),className:"btn-gradient px-6 py-3 rounded-2xl flex items-center gap-2 font-semibold touch-feedback",children:[e.jsx(h,{size:20}),r("property.add_property")]})]}),e.jsx(C,{onSearch:u,onFilter:U,filters:S,placeholder:"Search properties...",filterOptions:P}),I&&I.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map((t,s)=>{var a;return e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*s},className:"app-surface rounded-3xl overflow-hidden border border-app-border hover:shadow-app-lg transition-all duration-300 group relative",children:[e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsx("input",{type:"checkbox",checked:p.includes(t._id),onChange:e=>{e.target.checked?m(e=>[...e,t._id]):m(e=>e.filter(e=>e!==t._id))},className:"w-5 h-5 rounded border-2 border-white bg-white/90 backdrop-blur-sm"})}),e.jsxs("div",{className:"h-48 bg-gradient-to-br from-brand-blue to-brand-orange relative overflow-hidden",children:[t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(d,{size:48,className:"text-white/80"})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium "+("Active"===t.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:t.status})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-text-primary mb-2",children:t.name}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-sm",children:[e.jsx(b,{size:14}),e.jsx("span",{children:(null==(a=t.address)?void 0:a.formattedAddress)||"Address not available"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-sm",children:[e.jsx(y,{size:14}),e.jsxs("span",{children:[t.numberOfUnits," ",1===t.numberOfUnits?r("property.unit"):r("property.units")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{to:`/dashboard/properties/${t._id}`,className:"flex-1 bg-app-bg hover:bg-app-border text-text-primary py-2 px-4 rounded-xl text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(f,{size:14}),r("property.view")]}),e.jsxs("button",{className:"flex-1 app-gradient text-white py-2 px-4 rounded-xl text-sm font-medium hover:shadow-app transition-all flex items-center justify-center gap-2",children:[e.jsx(j,{size:14}),r("property.edit")]})]})]})]},t._id)})}):e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 app-gradient rounded-3xl flex items-center justify-center mx-auto mb-6",children:e.jsx(d,{size:48,className:"text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-text-primary mb-2",children:r("property.no_properties_yet")}),e.jsx("p",{className:"text-text-secondary mb-8 max-w-md mx-auto",children:r("property.manage_portfolio")}),e.jsxs("button",{onClick:()=>c(!0),className:"btn-gradient px-8 py-4 rounded-2xl font-semibold flex items-center gap-2 mx-auto",children:[e.jsx(h,{size:20}),r("property.add_first_property")]})]}),e.jsx(k,{isOpen:n,onClose:()=>c(!1),onPropertyAdded:e=>{O.setQueryData(["properties"],t=>[...t||[],e])}}),e.jsx(z,{selectedItems:p,totalItems:(null==I?void 0:I.length)||0,onSelectAll:()=>m((null==I?void 0:I.map(e=>e._id))||[]),onClearSelection:()=>m([]),actions:T})]})};export{S as default};
