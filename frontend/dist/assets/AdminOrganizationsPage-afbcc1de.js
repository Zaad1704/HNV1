import{j as e,b as t}from"./index-7df8bb8f.js";import{a,u as r,c as i}from"./query-c0dd8be7.js";import{x as s,a5 as n,s as o,am as d,an as l,q as c,ad as x}from"./ui-88b07fc3.js";import"./vendor-83d6deea.js";import"./router-225372b8.js";import"./i18n-eaa6a7d3.js";import"./utils-2ffb253a.js";const u=async()=>{const{data:e}=await t.get("/super-admin/organizations");return e.data},g=async()=>{const{data:e}=await t.get("/plans");return e.data},m=()=>{const m=a(),{data:b=[],isLoading:h,isError:p}=r({queryKey:["allOrganizations"],queryFn:u});r({queryKey:["availablePlans"],queryFn:g});const v=i({mutationFn:e=>t.delete(`/super-admin/organizations/${e}`),onSuccess:()=>m.invalidateQueries({queryKey:["allOrganizations"]}),onError:e=>{var t,a;return alert((null==(a=null==(t=e.response)?void 0:t.data)?void 0:a.message)||"Failed to delete organization.")}}),k=i({mutationFn:({orgId:e,action:a})=>t.patch(`/super-admin/organizations/${e}/${a}`),onSuccess:()=>m.invalidateQueries({queryKey:["allOrganizations"]}),onError:e=>{var t,a;return alert((null==(a=null==(t=e.response)?void 0:t.data)?void 0:a.message)||"Failed to update organization status.")}}),j=i({mutationFn:({orgId:e,action:a})=>t.patch(`/super-admin/organizations/${e}/${a}`),onSuccess:()=>m.invalidateQueries({queryKey:["allOrganizations"]}),onError:e=>{var t,a;return alert((null==(a=null==(t=e.response)?void 0:t.data)?void 0:a.message)||"Failed to update lifetime access.")}});return h?e.jsx("div",{className:"text-center p-8 text-dark-text dark:text-dark-text-dark",children:"Loading organizations..."}):p?e.jsx("div",{className:"text-center text-red-400 p-8",children:"Failed to fetch organizations."}):e.jsxs("div",{className:"text-dark-text dark:text-dark-text-dark",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Manage All Organizations"}),e.jsx("div",{className:"bg-light-card rounded-xl border border-border-color overflow-hidden shadow-lg dark:bg-dark-card dark:border-border-color-dark",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-light-bg border-b border-border-color dark:bg-dark-bg/50 dark:border-border-color-dark",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 uppercase text-sm font-semibold text-light-text dark:text-light-text-dark",children:"Organization"}),e.jsx("th",{className:"p-4 uppercase text-sm font-semibold text-light-text dark:text-light-text-dark",children:"Plan"}),e.jsx("th",{className:"p-4 uppercase text-sm font-semibold text-light-text dark:text-light-text-dark",children:"Status"}),e.jsx("th",{className:"p-4 uppercase text-sm font-semibold text-light-text text-right dark:text-light-text-dark",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border-color dark:divide-border-color-dark",children:b.map(t=>{var a,r,i,u,g,m,b,h,p;return e.jsxs("tr",{className:"hover:bg-light-bg transition-colors duration-150 dark:hover:bg-dark-bg/40",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("p",{className:"font-bold text-dark-text dark:text-dark-text-dark",children:t.name}),e.jsx("p",{className:"text-sm text-light-text dark:text-light-text-dark",children:null==(a=t.owner)?void 0:a.email})]}),e.jsx("td",{className:"p-4",children:(null==(r=t.subscription)?void 0:r.isLifetime)?e.jsxs("span",{className:"inline-flex items-center gap-2 px-2 py-1 text-xs font-semibold rounded-full bg-brand-accent-dark/20 text-brand-accent-dark",children:[e.jsx(s,{size:14})," Lifetime"]}):e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-light-text/10 text-light-text dark:text-light-text-dark",children:(null==(u=null==(i=t.subscription)?void 0:i.planId)?void 0:u.name)||"No Plan"})}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full capitalize "+("active"===(null==(g=t.subscription)?void 0:g.status)||"trialing"===(null==(m=t.subscription)?void 0:m.status)?"bg-green-500/20 text-green-300":"bg-brand-orange/20 text-brand-orange"),children:[" ",(null==(b=t.subscription)?void 0:b.status)||"inactive"]})}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:["active"===(null==(h=t.subscription)?void 0:h.status)?e.jsx("button",{onClick:()=>k.mutate({orgId:t._id,action:"deactivate"}),className:"p-2 rounded-md text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Deactivate",children:e.jsx(n,{size:16})}):e.jsx("button",{onClick:()=>k.mutate({orgId:t._id,action:"activate"}),className:"p-2 rounded-md text-green-500 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:"Activate",children:e.jsx(o,{size:16})}),(null==(p=t.subscription)?void 0:p.isLifetime)?e.jsx("button",{onClick:()=>j.mutate({orgId:t._id,action:"revoke-lifetime"}),className:"p-2 rounded-md text-orange-500 hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors",title:"Revoke Lifetime",children:e.jsx(d,{size:16})}):e.jsx("button",{onClick:()=>j.mutate({orgId:t._id,action:"grant-lifetime"}),className:"p-2 rounded-md text-yellow-500 hover:bg-yellow-50 dark:hover:bg-yellow-900/20 transition-colors",title:"Grant Lifetime",children:e.jsx(l,{size:16})}),e.jsx("button",{className:"p-2 rounded-md text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:"Manage Subscription",children:e.jsx(c,{size:16})}),e.jsx("button",{onClick:()=>{return e=t._id,a=t.name,void(window.confirm(`Are you sure you want to PERMANENTLY DELETE the organization "${a}"? This will delete all associated users, properties, tenants, and billing data. This action cannot be undone.`)&&v.mutate(e));var e,a},className:"p-2 rounded-md text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete Organization Permanently",children:e.jsx(x,{size:16})})]})})]},t._id)})})]})})]})};export{m as default};
