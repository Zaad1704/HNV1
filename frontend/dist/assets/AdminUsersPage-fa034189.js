import{j as e,b as t}from"./index-7df8bb8f.js";import{r}from"./vendor-83d6deea.js";import{a,u as s,c as d}from"./query-c0dd8be7.js";import{ab as l,k as i,ad as n,X as o,h as x}from"./ui-88b07fc3.js";import"./router-225372b8.js";import"./i18n-eaa6a7d3.js";import"./utils-2ffb253a.js";const c=()=>{var c;const[m,g]=r.useState(""),[h,u]=r.useState(null),b=a(),{data:p=[],isLoading:k,isError:j}=s({queryKey:["allAdminUsers"],queryFn:async()=>(await t.get("/super-admin/users")).data.data}),y=d({mutationFn:e=>t.delete(`/super-admin/users/${e}`),onSuccess:()=>{b.invalidateQueries({queryKey:["allAdminUsers"]}),u(null)},onError:e=>{var t,r;return alert((null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.message)||"Failed to delete user.")}}),N=d({mutationFn:({userId:e,planId:r})=>t.put(`/super-admin/users/${e}/plan`,{planId:r}),onSuccess:()=>{b.invalidateQueries({queryKey:["allAdminUsers"]}),alert("User plan updated successfully")},onError:e=>{var t,r;return alert((null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.message)||"Failed to update plan.")}});s({queryKey:["plans"],queryFn:async()=>(await t.get("/super-admin/plans")).data.data});const v=e=>{window.confirm(`Are you sure you want to delete user "${e.name}" (${e.email})? This action cannot be undone.`)&&y.mutate(e._id)},f=r.useMemo(()=>m?p.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.email.toLowerCase().includes(m.toLowerCase())):p,[p,m]);return k?e.jsx("div",{className:"p-4 text-center text-dark-text dark:text-dark-text-dark",children:"Loading users..."}):j?e.jsx("div",{className:"p-4 text-center text-red-400 dark:text-red-400",children:"Failed to fetch users."}):e.jsxs("div",{className:"text-dark-text dark:text-dark-text-dark",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Manage All Users"}),e.jsx("input",{type:"text",placeholder:"Search by name or email...",value:m,onChange:e=>g(e.target.value),className:"mb-6 p-3 border border-border-color rounded-lg w-full bg-light-card text-dark-text focus:ring-brand-primary focus:border-brand-primary transition-all dark:bg-dark-card dark:border-border-color-dark dark:text-dark-text-dark"}),e.jsx("div",{className:"bg-light-card p-6 rounded-xl shadow-lg border border-border-color overflow-x-auto dark:bg-dark-card dark:border-border-color-dark",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-light-bg border-b border-border-color dark:bg-dark-bg/50 dark:border-border-color-dark",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-semibold text-light-text uppercase text-sm dark:text-light-text-dark",children:"Name"}),e.jsx("th",{className:"text-left p-4 font-semibold text-light-text uppercase text-sm dark:text-light-text-dark",children:"Email"}),e.jsx("th",{className:"text-left p-4 font-semibold text-light-text uppercase text-sm dark:text-light-text-dark",children:"Role"}),e.jsx("th",{className:"text-left p-4 font-semibold text-light-text uppercase text-sm dark:text-light-text-dark",children:"Organization"}),e.jsx("th",{className:"text-right p-4 font-semibold text-light-text uppercase text-sm dark:text-light-text-dark",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border-color dark:divide-border-color-dark",children:f.map(t=>{var r;return e.jsxs("tr",{className:"hover:bg-light-bg transition-colors duration-150 dark:hover:bg-dark-bg/40",children:[e.jsx("td",{className:"p-4 font-medium text-dark-text dark:text-dark-text-dark",children:t.name}),e.jsx("td",{className:"p-4 text-light-text dark:text-light-text-dark",children:t.email}),e.jsx("td",{className:"p-4 text-light-text dark:text-light-text-dark",children:t.role}),e.jsx("td",{className:"p-4 text-light-text dark:text-light-text-dark",children:(null==(r=t.organizationId)?void 0:r.name)||"N/A"}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>u(t),className:"p-2 rounded-md text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:"View Details",children:e.jsx(l,{size:16})}),e.jsx("button",{onClick:()=>{const e=prompt("Enter Plan ID for user:");e&&N.mutate({userId:t._id,planId:e})},className:"p-2 rounded-md text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",title:"Manage Billing",children:e.jsx(i,{size:16})}),e.jsx("button",{onClick:()=>v(t),className:"p-2 rounded-md text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete User",children:e.jsx(n,{size:16})})]})})]},t._id)})})]})}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"User Details"}),e.jsx("button",{onClick:()=>u(null),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(o,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Name"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:h.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Email"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:h.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Role"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:h.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Organization"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:(null==(c=h.organizationId)?void 0:c.name)||"No Organization"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Email Verified"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:h.isEmailVerified?"Yes":"No"})]}),h.createdAt&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Created"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:new Date(h.createdAt).toLocaleDateString()})]}),h.lastLogin&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Last Login"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:new Date(h.lastLogin).toLocaleDateString()})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsxs("button",{onClick:()=>{const e=prompt("Enter Plan ID:");e&&N.mutate({userId:h._id,planId:e})},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(x,{size:16}),"Update Plan"]}),e.jsx("button",{onClick:()=>v(h),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete User"}),e.jsx("button",{onClick:()=>u(null),className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Close"})]})]})})]})};export{c as default};
