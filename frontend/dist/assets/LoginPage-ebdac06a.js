import{c as e,j as a,b as s}from"./index-7df8bb8f.js";import{r as t}from"./vendor-83d6deea.js";import{a as r,L as i}from"./router-225372b8.js";import{u as l}from"./i18n-eaa6a7d3.js";import{m as o,$ as n,V as d,e as c,a0 as u}from"./ui-88b07fc3.js";import"./utils-2ffb253a.js";import"./query-c0dd8be7.js";const m=()=>{const[m,p]=t.useState(""),[x,b]=t.useState(""),[h,f]=t.useState(""),[g,y]=t.useState(!1),v=r(),{login:j}=e(),{t:N}=l(),w=async(e,a=0)=>{var t,r,i,l,o,n;if(e.preventDefault(),y(!0),f(""),!m.trim())return f("Email is required"),void y(!1);if(!x.trim())return f("Password is required"),void y(!1);if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m))return f("Please enter a valid email address"),void y(!1);try{const e=await s.post("/auth/login",{email:m.trim().toLowerCase(),password:x});e.data.success&&e.data.token&&e.data.user?(j(e.data.token,e.data.user),f(""),v("/dashboard",{replace:!0})):f("Invalid response from server. Please try again.")}catch(d){const s=null==(r=null==(t=d.response)?void 0:t.data)?void 0:r.code,c=null==(l=null==(i=d.response)?void 0:i.data)?void 0:l.message,u=null==(o=d.response)?void 0:o.status;switch(s){case"MISSING_CREDENTIALS":f("Please provide both email and password.");break;case"INVALID_CREDENTIALS":f("Invalid email or password. Please check your credentials.");break;case"ACCOUNT_SUSPENDED":f("Your account has been suspended. Please contact support.");break;case"EMAIL_NOT_VERIFIED":f("Please verify your email address before logging in.");break;case"SERVER_ERROR":f("Server error. Please try again in a moment.");break;case"OAUTH_NOT_CONFIGURED":f("Google login is temporarily unavailable. Please use email/password.");break;default:if("ECONNABORTED"===d.code||(null==(n=d.message)?void 0:n.includes("timeout"))||u>=500||"ERR_NETWORK"===d.code||!navigator.onLine){if(a<3)return f(`Connection issue... Retrying (${a+1}/4)`),void setTimeout(()=>{w(e,a+1)},Math.min(2e3*Math.pow(2,a),1e4));f("Unable to connect to server. Please check your internet connection and try again.")}else f(429===u?"Too many login attempts. Please wait a few minutes and try again.":c||"Login failed. Please try again.")}}finally{0===a&&y(!1)}};return a.jsx("div",{className:"min-h-screen bg-app-bg flex items-center justify-center p-4",children:a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"w-20 h-20 app-gradient rounded-3xl flex items-center justify-center mx-auto mb-6",children:a.jsx(n,{size:32,className:"text-white"})}),a.jsx("h1",{className:"text-4xl font-bold text-text-primary mb-2",children:N("auth.welcome_back")}),a.jsx("p",{className:"text-text-secondary",children:N("auth.sign_in_subtitle")})]}),a.jsxs("div",{className:"app-surface rounded-3xl p-8 border border-app-border shadow-app-lg",children:[h&&a.jsx(o.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"px-4 py-3 rounded-2xl text-center text-sm mb-6 "+(h.includes("Retrying")?"bg-yellow-50 border border-yellow-200 text-yellow-700":"bg-red-50 border border-red-200 text-red-600"),role:"alert","aria-live":"polite",children:h}),a.jsxs("form",{onSubmit:w,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:N("auth.email_address")}),a.jsxs("div",{className:"relative",children:[a.jsx(d,{size:20,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-text-muted"}),a.jsx("input",{type:"email",name:"email",required:!0,autoComplete:"email",value:m,onChange:e=>p(e.target.value),className:"w-full pl-12 pr-4 py-4 rounded-2xl border border-app-border bg-app-surface text-text-primary focus:border-brand-blue focus:ring-4 focus:ring-brand-blue/10 transition-all",placeholder:N("auth.enter_email"),"aria-describedby":"email-error"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-text-secondary",children:N("auth.password")}),a.jsx(i,{to:"/forgot-password",className:"text-sm text-brand-blue hover:text-brand-blue/80 font-medium",children:N("auth.forgot_password")})]}),a.jsxs("div",{className:"relative",children:[a.jsx(n,{size:20,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-text-muted"}),a.jsx("input",{type:"password",name:"password",required:!0,value:x,onChange:e=>b(e.target.value),className:"w-full pl-12 pr-4 py-3 rounded-2xl border border-app-border bg-app-surface text-text-primary focus:border-brand-blue focus:ring-4 focus:ring-brand-blue/10 transition-all",placeholder:N("auth.enter_password")})]})]}),a.jsx("button",{type:"submit",disabled:g,className:"w-full btn-gradient py-4 text-lg font-semibold rounded-2xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:g?a.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[N("auth.sign_in"),a.jsx(c,{size:20})]})})]}),a.jsxs("div",{className:"relative flex items-center justify-center my-8",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-app-border"})}),a.jsx("div",{className:"relative bg-app-surface px-4",children:a.jsx("span",{className:"text-text-muted text-sm font-medium",children:N("auth.or")})})]}),a.jsxs("button",{onClick:()=>{try{const e=s.defaults.baseURL,a=`${e}/auth/google?role=${"Landlord"}`;window.location.href=a}catch(e){f("Google login is temporarily unavailable. Please try again.")}},className:"w-full flex justify-center items-center gap-3 py-4 border border-app-border rounded-2xl font-semibold text-text-primary bg-app-surface hover:bg-app-bg transition-all duration-300 hover:shadow-app",children:[a.jsx(u,{size:20}),N("auth.continue_google")]}),a.jsx("div",{className:"mt-8 text-center",children:a.jsxs("p",{className:"text-text-secondary",children:[N("auth.no_account")," ",a.jsx(i,{to:"/register",className:"font-semibold text-brand-blue hover:text-brand-blue/80 transition-colors",children:N("auth.sign_up")})]})})]})]})})};export{m as default};
