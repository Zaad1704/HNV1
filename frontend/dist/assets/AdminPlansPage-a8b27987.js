import{j as e,b as s}from"./index-7df8bb8f.js";import{r as t}from"./vendor-83d6deea.js";import{a,m as i,X as n,af as l,a6 as r,ac as c,ad as d,k as x}from"./ui-88b07fc3.js";import{a as m,u as o,c as u}from"./query-c0dd8be7.js";import"./router-225372b8.js";import"./i18n-eaa6a7d3.js";import"./utils-2ffb253a.js";const p=({isOpen:s,onClose:r,onSave:c,plan:d})=>{const[x,m]=t.useState({name:"",price:"",duration:"monthly",features:"",limits:{maxProperties:10,maxTenants:50,maxAgents:5},isPublic:!0});t.useEffect(()=>{var e;d&&m({name:d.name||"",price:(null==(e=d.price)?void 0:e.toString())||"",duration:d.duration||"monthly",features:d.features||"",limits:d.limits||{maxProperties:10,maxTenants:50,maxAgents:5},isPublic:d.isPublic??!0})},[d]);const o=e=>{const{name:s,value:t,type:a}=e.target;if("checkbox"===a){const t=e.target.checked;m(e=>({...e,[s]:t}))}else m(e=>({...e,[s]:t}))},u=(e,s)=>{m(t=>({...t,limits:{...t.limits,[e]:s}}))};return e.jsx(a,{children:s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex justify-center items-center p-4",children:e.jsxs(i.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"app-surface rounded-3xl shadow-app-xl w-full max-w-lg border border-app-border",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-app-border",children:[e.jsx("h2",{className:"text-xl font-bold text-text-primary",children:d?"Edit Plan":"Create Plan"}),e.jsx("button",{onClick:r,className:"p-2 rounded-full text-text-secondary hover:text-text-primary",children:e.jsx(n,{size:20})})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),c({...x,price:parseFloat(x.price)}),r()},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Plan Name"}),e.jsx("input",{type:"text",name:"name",value:x.name,onChange:o,required:!0,className:"w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Price"}),e.jsx("input",{type:"number",name:"price",value:x.price,onChange:o,required:!0,step:"0.01",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Duration"}),e.jsxs("select",{name:"duration",value:x.duration,onChange:o,className:"w-full",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"2-years",children:"2 Years"}),e.jsx("option",{value:"3-years",children:"3 Years"}),e.jsx("option",{value:"5-years",children:"5 Years"}),e.jsx("option",{value:"lifetime",children:"Lifetime"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Features"}),e.jsx("textarea",{name:"features",value:x.features,onChange:o,rows:3,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Limits"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Properties"}),e.jsx("input",{type:"number",value:x.limits.maxProperties,onChange:e=>u("maxProperties",parseInt(e.target.value)),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Tenants"}),e.jsx("input",{type:"number",value:x.limits.maxTenants,onChange:e=>u("maxTenants",parseInt(e.target.value)),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Agents"}),e.jsx("input",{type:"number",value:x.limits.maxAgents,onChange:e=>u("maxAgents",parseInt(e.target.value)),className:"w-full"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isPublic",checked:x.isPublic,onChange:o,className:"rounded"}),e.jsx("label",{className:"text-sm text-text-secondary",children:"Public Plan"})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 rounded-2xl border border-app-border text-text-secondary hover:text-text-primary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-gradient px-6 py-3 rounded-2xl flex items-center gap-2",children:[e.jsx(l,{size:16}),d?"Update":"Create"," Plan"]})]})]})]})})})},h=async()=>{const{data:e}=await s.get("/super-admin/plans");return e.data},j=async e=>{const{data:t}=await s.post("/super-admin/plans",e);return t.data},y=async({id:e,...t})=>{const{data:a}=await s.put(`/super-admin/plans/${e}`,t);return a.data},b=async e=>{await s.delete(`/super-admin/plans/${e}`)},f=()=>{const s=m(),[a,n]=t.useState(!1),[l,f]=t.useState(null),{data:v=[],isLoading:g}=o({queryKey:["adminPlans"],queryFn:h}),N=u({mutationFn:j,onSuccess:()=>{s.invalidateQueries({queryKey:["adminPlans"]}),n(!1)}}),P=u({mutationFn:y,onSuccess:()=>{s.invalidateQueries({queryKey:["adminPlans"]}),n(!1),f(null)}}),w=u({mutationFn:b,onSuccess:()=>{s.invalidateQueries({queryKey:["adminPlans"]})}});return g?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"w-8 h-8 app-gradient rounded-full animate-pulse"}),e.jsx("span",{className:"ml-3 text-text-secondary",children:"Loading plans..."})]}):e.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:"Subscription Plans"}),e.jsx("p",{className:"text-text-secondary mt-1",children:"Manage pricing plans and features"})]}),e.jsxs("button",{onClick:()=>{f(null),n(!0)},className:"btn-gradient px-6 py-3 rounded-2xl flex items-center gap-2 font-semibold",children:[e.jsx(r,{size:20}),"Add Plan"]})]}),v.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((s,t)=>e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"app-surface rounded-3xl p-6 border border-app-border hover:shadow-app-lg transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-text-primary",children:s.name}),e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium "+(s.isPublic?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:s.isPublic?"Public":"Private"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("span",{className:"text-3xl font-bold text-text-primary",children:["$",s.price]}),e.jsxs("span",{className:"text-text-secondary",children:["/",s.duration]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-text-secondary mb-2",children:"Limits:"}),e.jsxs("div",{className:"text-xs text-text-muted space-y-1",children:[e.jsxs("div",{children:["Properties: ",s.limits.maxProperties]}),e.jsxs("div",{children:["Tenants: ",s.limits.maxTenants]}),e.jsxs("div",{children:["Agents: ",s.limits.maxAgents]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>(e=>{f(e),n(!0)})(s),className:"flex-1 bg-app-bg hover:bg-app-border text-text-primary py-2 px-4 rounded-xl text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(c,{size:14}),"Edit"]}),e.jsxs("button",{onClick:()=>{return e=s._id,void(confirm("Are you sure you want to delete this plan?")&&w.mutate(e));var e},className:"flex-1 bg-red-50 hover:bg-red-100 text-red-600 py-2 px-4 rounded-xl text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx(d,{size:14}),"Delete"]})]})]},s._id))}):e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 app-gradient rounded-3xl flex items-center justify-center mx-auto mb-6",children:e.jsx(x,{size:48,className:"text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-text-primary mb-2",children:"No Plans Yet"}),e.jsx("p",{className:"text-text-secondary mb-8 max-w-md mx-auto",children:"Create your first subscription plan to start monetizing your platform."}),e.jsxs("button",{onClick:()=>{f(null),n(!0)},className:"btn-gradient px-8 py-4 rounded-2xl font-semibold flex items-center gap-2 mx-auto",children:[e.jsx(r,{size:20}),"Create First Plan"]})]}),e.jsx(p,{isOpen:a,onClose:()=>{n(!1),f(null)},onSave:e=>{l?P.mutate({id:l._id,...e}):N.mutate(e)},plan:l})]})};export{f as default};
