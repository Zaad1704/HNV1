import{j as e,a as t,c as a,b as s}from"./index-7df8bb8f.js";import{r}from"./vendor-83d6deea.js";import{L as i}from"./router-225372b8.js";import{R as n,B as d,C as o,X as l,Y as c,T as x,a as m,P as u,b as p,c as h}from"./charts-a3223c4c.js";import{E as y,a2 as v,a6 as b,m as f,j,U as g,k as N,n as w,F as k,a7 as _,R,h as T,p as z,o as S}from"./ui-88b07fc3.js";import{u as q}from"./i18n-eaa6a7d3.js";import{a as L,u as A,c as $}from"./query-c0dd8be7.js";import"./utils-2ffb253a.js";const K=({data:t})=>e.jsx("div",{className:"h-80",children:e.jsx(n,{width:"100%",height:"100%",children:e.jsxs(d,{data:t,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(o,{strokeDasharray:"3 3",stroke:"var(--app-border)"}),e.jsx(l,{dataKey:"name",stroke:"var(--text-secondary)",fontSize:12}),e.jsx(c,{stroke:"var(--text-secondary)",fontSize:12}),e.jsx(x,{contentStyle:{backgroundColor:"var(--app-surface)",border:"1px solid var(--app-border)",borderRadius:"12px",color:"var(--text-primary)"}}),e.jsx(m,{dataKey:"Revenue",fill:"#4A69E2",radius:[4,4,0,0]}),e.jsx(m,{dataKey:"Expenses",fill:"#FFA87A",radius:[4,4,0,0]})]})})}),E=["#22c55e","#ef4444"],P=({data:t})=>e.jsxs("div",{className:"h-64",children:[e.jsx(n,{width:"100%",height:"100%",children:e.jsxs(u,{children:[e.jsx(p,{data:t,cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:5,dataKey:"value",children:t.map((t,a)=>e.jsx(h,{fill:E[a%E.length]},`cell-${a}`))}),e.jsx(x,{contentStyle:{backgroundColor:"var(--app-surface)",border:"1px solid var(--app-border)",borderRadius:"12px",color:"var(--text-primary)"}})]})}),e.jsx("div",{className:"mt-4 flex justify-center gap-4",children:t.map((t,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:E[a%E.length]}}),e.jsx("span",{className:"text-sm text-text-secondary",children:t.name})]},t.name))})]}),C=({title:t,items:a,actionText:s,emptyText:r,linkTo:n,onActionClick:d,isActionLoading:o,loadingItemId:l})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:t}),e.jsxs(i,{to:n,className:"text-brand-blue hover:text-brand-blue/80 text-sm font-medium flex items-center gap-1",children:["View All ",e.jsx(y,{size:14})]})]}),a.length>0?e.jsx("div",{className:"space-y-3",children:a.slice(0,3).map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-app-bg rounded-2xl",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-text-primary text-sm",children:t.primaryText}),e.jsx("p",{className:"text-text-secondary text-xs mt-1",children:t.secondaryText})]}),d&&e.jsx("button",{onClick:()=>d(t.id),disabled:o&&l===t.id,className:"bg-brand-blue text-white px-3 py-1.5 rounded-lg text-xs font-medium hover:bg-brand-blue/90 transition-colors disabled:opacity-50",children:o&&l===t.id?e.jsx("div",{className:"w-3 h-3 border border-white/30 border-t-white rounded-full animate-spin"}):s})]},t.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{size:32,className:"mx-auto text-text-muted mb-3"}),e.jsx("p",{className:"text-text-secondary text-sm",children:r})]})]}),F=()=>{q();const t=[{icon:j,label:"Add Property",description:"Add new property",color:"from-blue-500 to-blue-600",action:()=>{}},{icon:g,label:"Add Tenant",description:"Register new tenant",color:"from-green-500 to-green-600",action:()=>{}},{icon:N,label:"Record Payment",description:"Log rent payment",color:"from-purple-500 to-purple-600",action:()=>{}},{icon:w,label:"Maintenance",description:"Create request",color:"from-orange-500 to-orange-600",action:()=>{}},{icon:k,label:"Generate Report",description:"Financial report",color:"from-indigo-500 to-indigo-600",action:()=>{}},{icon:_,label:"Send Message",description:"Contact tenant",color:"from-pink-500 to-pink-600",action:()=>{}}];return e.jsxs("div",{className:"app-surface rounded-3xl p-6 border border-app-border",children:[e.jsxs("h2",{className:"text-xl font-bold text-text-primary mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 app-gradient rounded-lg flex items-center justify-center",children:e.jsx(b,{size:16,className:"text-white"})}),"Quick Actions"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:t.map((t,a)=>e.jsxs(f.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*a},onClick:t.action,className:"group p-4 rounded-2xl bg-app-bg hover:bg-app-border transition-all duration-300 text-left touch-feedback",children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${t.color} rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform`,children:e.jsx(t.icon,{size:20,className:"text-white"})}),e.jsx("h3",{className:"font-semibold text-text-primary text-sm mb-1",children:t.label}),e.jsx("p",{className:"text-xs text-text-secondary",children:t.description})]},t.label))})]})},I=async()=>{const{data:e}=await s.get("/dashboard/overview-stats");return e.data},D=async()=>{const{data:e}=await s.get("/dashboard/late-tenants");return e.data},Y=async()=>{const{data:e}=await s.get("/dashboard/expiring-leases");return e.data},M=async()=>{const{data:e}=await s.get("/dashboard/financial-summary");return e.data},Q=async()=>{const{data:e}=await s.get("/dashboard/rent-status");return e.data},U=async e=>{const{data:t}=await s.post("/communication/send-rent-reminder",{tenantId:e});return t},B=({title:t,value:a,icon:s,to:r,delay:n=0,trend:d})=>e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n,duration:.5},children:e.jsxs(i,{to:r,className:"app-card app-surface rounded-3xl p-6 flex items-center justify-between hover:shadow-app-lg transition-all duration-300 group touch-feedback",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-text-secondary group-hover:text-text-primary transition-colors",children:t}),e.jsx("p",{className:"text-3xl font-bold text-text-primary mt-2",children:a}),d&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-sm "+(d.isPositive?"text-green-500":"text-red-500"),children:[e.jsx(S,{size:14,className:d.isPositive?"":"rotate-180"}),e.jsxs("span",{children:[Math.abs(d.value),"%"]})]})]}),e.jsx("div",{className:"w-14 h-14 app-gradient rounded-2xl flex items-center justify-center text-white group-hover:scale-110 transition-transform duration-300",children:s})]})}),G=()=>{var s,i;const{t:n}=q(),{currency:d}=t(),{user:o}=a(),l=L(),[c,x]=r.useState(null),{isRefreshing:m,pullDistance:u,isPulling:p}=(({onRefresh:e,threshold:t=80,resistance:a=2.5})=>{const[s,i]=r.useState(!1),[n,d]=r.useState(0),o=r.useRef(0),l=r.useRef(0),c=r.useRef(!1),x=e=>{0===window.scrollY&&(o.current=e.touches[0].clientY,c.current=!0)},m=e=>{if(!c.current||s)return;l.current=e.touches[0].clientY;const r=l.current-o.current;if(r>0&&0===window.scrollY){e.preventDefault();const s=Math.min(r/a,1.5*t);d(s)}},u=async()=>{if(c.current){if(c.current=!1,n>=t&&!s){i(!0);try{await e()}finally{i(!1)}}d(0)}};return r.useEffect(()=>(document.addEventListener("touchstart",x,{passive:!1}),document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",u),()=>{document.removeEventListener("touchstart",x),document.removeEventListener("touchmove",m),document.removeEventListener("touchend",u)}),[n,s,t,a]),{isRefreshing:s,pullDistance:n,isPulling:n>0}})({onRefresh:async()=>{await l.invalidateQueries({queryKey:["overviewStats"]}),await l.invalidateQueries({queryKey:["lateTenants"]}),await l.invalidateQueries({queryKey:["expiringLeases"]}),await l.invalidateQueries({queryKey:["financialSummary"]}),await l.invalidateQueries({queryKey:["rentStatus"]})},threshold:80}),{data:h,isLoading:y}=A({queryKey:["overviewStats"],queryFn:I}),{data:b}=A({queryKey:["lateTenants"],queryFn:D}),{data:N}=A({queryKey:["expiringLeases"],queryFn:Y}),{data:w}=A({queryKey:["financialSummary"],queryFn:M}),{data:k}=A({queryKey:["rentStatus"],queryFn:Q}),_=$({mutationFn:U,onSuccess:(e,t)=>{alert(e.message||`Reminder sent to tenant ${t}!`)},onError:e=>{var t,a;alert(`Failed to send reminder: ${(null==(a=null==(t=e.response)?void 0:t.data)?void 0:a.message)||e.message}`)},onSettled:()=>{x(null)}});if(y)return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"w-8 h-8 app-gradient rounded-full animate-pulse"}),e.jsx("span",{className:"ml-3 text-text-secondary",children:n("dashboard.loading_data")})]});const E=(null==b?void 0:b.map(e=>{var t;return{id:e._id,primaryText:`${e.name} (${(null==(t=e.propertyId)?void 0:t.name)||"N/A"})`,secondaryText:`Unit: ${e.unit}`}}))||[],G=(null==N?void 0:N.map(e=>{var t;return{id:e._id,primaryText:`${e.name} (${(null==(t=e.propertyId)?void 0:t.name)||"N/A"})`,secondaryText:`Expires: ${new Date(e.leaseEndDate).toLocaleDateString()}`}}))||[];return e.jsxs("div",{className:"relative",children:[(p||m)&&e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 flex justify-center pt-4",style:{transform:`translateY(${Math.min(u,60)}px)`},children:e.jsx("div",{className:"bg-app-surface rounded-full p-3 shadow-app-lg border border-app-border",children:e.jsx(R,{size:20,className:"text-brand-blue "+(m?"animate-spin":"")})})}),e.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-8 pull-to-refresh",style:{transform:p?`translateY(${Math.min(.5*u,30)}px)`:"none",transition:p?"none":"transform 0.3s ease"},children:[e.jsxs("div",{className:"app-gradient rounded-3xl p-8 text-white relative overflow-hidden",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:["Welcome back, ",null==o?void 0:o.name,"!",(null==(s=null==o?void 0:o.organizationId)?void 0:s.name)&&e.jsxs("span",{className:"block text-xl font-normal text-white/90 mt-1",children:["to ",o.organizationId.name]})]}),e.jsx("p",{className:"text-white/80",children:"Here's what's happening with your properties today."})]}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-8 translate-x-8"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/5 rounded-full translate-y-8 -translate-x-8"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(B,{delay:.1,title:n("dashboard.monthly_revenue"),value:`${d}${(null==(i=null==h?void 0:h.monthlyRevenue)?void 0:i.toLocaleString())||0}`,icon:e.jsx(T,{size:24}),to:"/dashboard/cashflow",trend:{value:12,isPositive:!0}}),e.jsx(B,{delay:.2,title:n("dashboard.total_properties"),value:(null==h?void 0:h.totalProperties)||0,icon:e.jsx(j,{size:24}),to:"/dashboard/properties",trend:{value:5,isPositive:!0}}),e.jsx(B,{delay:.3,title:n("dashboard.active_tenants"),value:(null==h?void 0:h.activeTenants)||0,icon:e.jsx(g,{size:24}),to:"/dashboard/tenants",trend:{value:8,isPositive:!0}}),e.jsx(B,{delay:.4,title:n("dashboard.occupancy_rate"),value:(null==h?void 0:h.occupancyRate)||"0%",icon:e.jsx(z,{size:24}),to:"/dashboard/tenants",trend:{value:3,isPositive:!1}})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},className:"lg:col-span-2 app-surface rounded-3xl p-8 border border-app-border touch-feedback",children:[e.jsxs("h2",{className:"text-xl font-bold text-text-primary mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 app-gradient rounded-lg flex items-center justify-center",children:e.jsx(S,{size:16,className:"text-white"})}),n("dashboard.financials_chart_title")]}),e.jsx(K,{data:w||[]})]}),e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},className:"app-surface rounded-3xl p-8 border border-app-border touch-feedback",children:[e.jsxs("h2",{className:"text-xl font-bold text-text-primary mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 app-gradient rounded-lg flex items-center justify-center",children:e.jsx(v,{size:16,className:"text-white"})}),n("dashboard.rent_status_chart_title")]}),e.jsx(P,{data:k||[]})]})]}),e.jsx(F,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},className:"app-surface rounded-3xl p-8 border border-app-border",children:e.jsx(C,{title:n("dashboard.overdue_rent_reminders"),items:E,actionText:n("dashboard.send_reminder"),emptyText:n("dashboard.no_overdue_rent"),linkTo:"/dashboard/tenants?filter=late",onActionClick:e=>{x(e),_.mutate(e)},isActionLoading:_.isLoading,loadingItemId:c})}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},className:"app-surface rounded-3xl p-8 border border-app-border",children:e.jsx(C,{title:n("dashboard.upcoming_lease_expirations"),items:G,actionText:n("dashboard.renew_lease"),emptyText:n("dashboard.no_expiring_leases"),linkTo:"/dashboard/tenants?filter=expiring",onActionClick:e=>alert(`Renew Lease for ${e}`)})})]})]})]})};export{G as default};
