import{j as e,b as t}from"./index-7df8bb8f.js";import{r}from"./vendor-83d6deea.js";import{a,u as s,c as d}from"./query-c0dd8be7.js";import{m as i,n as l,H as n,ae as o,U as x}from"./ui-88b07fc3.js";import"./router-225372b8.js";import"./i18n-eaa6a7d3.js";import"./utils-2ffb253a.js";const c=async()=>{const{data:e}=await t.get("/maintenance");return e.data},h=async({id:e,status:r})=>{const{data:a}=await t.put(`/maintenance/${e}`,{status:r});return a.data},m=()=>{const t=a(),{data:m=[],isLoading:g,isError:u}=s(["maintenanceRequests"],c),{width:p}=function(){const[e,t]=r.useState({width:window.innerWidth,height:window.innerHeight});return r.useEffect(()=>{function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),e}(),b=d({mutationFn:h,onSuccess:()=>{t.invalidateQueries({queryKey:["maintenanceRequests"]})},onError:e=>{var t,r;alert(`Failed to update request status: ${(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.message)||e.message}`)}}),k=(e,t)=>{b.mutate({id:e,status:t})},j=e=>({Open:"bg-brand-primary/20 text-brand-primary","In Progress":"bg-yellow-500/20 text-yellow-300",Completed:"bg-green-500/20 text-green-300",Closed:"bg-gray-500/20 text-gray-300"}[e]||"bg-gray-500/20 text-gray-300");if(g)return e.jsx("div",{className:"text-center p-8 text-dark-text dark:text-dark-text-dark",children:"Loading requests..."});if(u)return e.jsx("div",{className:"text-center p-8 text-red-400 dark:text-red-400",children:"Failed to fetch maintenance requests."});const v=()=>e.jsx("div",{className:"bg-light-card rounded-3xl shadow-lg border border-border-color overflow-hidden dark:bg-dark-card dark:border-border-color-dark",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-light-bg/50 border-b border-border-color dark:bg-dark-bg/50 dark:border-border-color-dark",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"Date"}),e.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"Tenant"}),e.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"Property"}),e.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"Issue"}),e.jsx("th",{className:"p-4 text-sm font-semibold text-light-text uppercase dark:text-light-text-dark",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-border-color dark:divide-border-color-dark",children:m.length>0?m.map(t=>{var r,a;return e.jsxs("tr",{className:"hover:bg-light-bg/50 transition-colors duration-150 dark:hover:bg-dark-bg/40",children:[e.jsx("td",{className:"p-4 text-light-text dark:text-light-text-dark",children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("td",{className:"p-4 font-semibold text-dark-text dark:text-dark-text-dark",children:(null==(r=t.requestedBy)?void 0:r.name)||"N/A"}),e.jsx("td",{className:"p-4 text-light-text dark:text-light-text-dark",children:(null==(a=t.propertyId)?void 0:a.name)||"N/A"}),e.jsx("td",{className:"p-4 text-light-text dark:text-light-text-dark",children:t.description}),e.jsx("td",{className:"p-4",children:e.jsxs("select",{value:t.status,onChange:e=>k(t._id,e.target.value),className:`border-0 rounded-md py-1 px-2 text-xs font-semibold ${j(t.status)} bg-light-bg dark:bg-dark-card dark:text-dark-text-dark`,style:{appearance:"none"},disabled:b.isLoading,children:[e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Resolved",children:"Resolved"}),e.jsx("option",{value:"Closed",children:"Closed"})]})})]},t._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center text-light-text dark:text-light-text-dark",children:"No maintenance requests found."})})})]})})}),y=()=>e.jsx("div",{className:"grid grid-cols-1 gap-4",children:m.map((t,r)=>{var a,s;return e.jsxs(i.div,{className:"bg-light-card p-4 rounded-3xl border border-border-color shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*r},children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("h3",{className:"font-bold text-dark-text text-lg flex items-center gap-2 dark:text-dark-text-dark",children:[e.jsx(l,{size:18})," ",t.description]}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${j(t.status)}`,children:t.status})]}),e.jsxs("p",{className:"text-light-text text-sm flex items-center gap-2 mb-1 dark:text-light-text-dark",children:[e.jsx(n,{size:14})," Property: ",(null==(a=t.propertyId)?void 0:a.name)||"N/A"]}),e.jsxs("p",{className:"text-light-text text-sm flex items-center gap-2 mb-2 dark:text-light-text-dark",children:[e.jsx(o,{size:14})," Date: ",new Date(t.createdAt).toLocaleDateString()]}),e.jsxs("p",{className:"text-light-text text-sm flex items-center gap-2 mb-2 dark:text-light-text-dark",children:[e.jsx(x,{size:14})," Requested By: ",(null==(s=t.requestedBy)?void 0:s.name)||"N/A"]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{htmlFor:`status-${t._id}`,className:"block text-sm font-medium text-light-text mb-1 dark:text-light-text-dark",children:"Update Status:"}),e.jsxs("select",{id:`status-${t._id}`,value:t.status,onChange:e=>k(t._id,e.target.value),className:"block w-full border border-border-color rounded-md py-2 px-3 text-dark-text bg-light-bg focus:ring-brand-primary focus:border-brand-primary dark:bg-dark-bg dark:border-border-color-dark dark:text-dark-text-dark",disabled:b.isLoading,children:[e.jsx("option",{value:"Open",children:"Open"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Resolved",children:"Resolved"}),e.jsx("option",{value:"Closed",children:"Closed"})]})]})]},t._id)})});return e.jsxs(i.div,{initial:"initial",animate:"in",exit:"out",variants:{initial:{opacity:0,y:20},in:{opacity:1,y:0},out:{opacity:0,y:-20}},transition:{duration:.4},className:"text-dark-text dark:text-dark-text-dark",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Maintenance Requests"}),m.length>0?p<768?e.jsx(y,{}):e.jsx(v,{}):e.jsxs("div",{className:"text-center py-16 bg-light-card rounded-3xl border border-dashed border-border-color dark:bg-dark-card dark:border-border-color-dark",children:[e.jsx("h3",{className:"text-xl font-semibold text-dark-text dark:text-dark-text-dark",children:"No Maintenance Requests Found"}),e.jsx("p",{className:"text-light-text mt-2 mb-4 dark:text-light-text-dark",children:"You can submit requests from your tenant portal or properties page."})]})]})};export{m as default};
